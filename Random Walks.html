

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Random Walks &#8212; Physics 246</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Random Walks';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Markov Chains" href="Markov%20Chains.html" />
    <link rel="prev" title="Chaos" href="chaos.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/FD.png" class="logo__image only-light" alt="Physics 246 - Home"/>
    <script>document.write(`<img src="_static/FD.png" class="logo__image only-dark" alt="Physics 246 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    An Introduction to Modern Computational Physics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="N_Ways_of_Measuring_PI.html">N ways to measure <span class="math notranslate nohighlight">\(\pi\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="Dynamics.html">Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="OrbitalDynamics.html">Orbital Dynamics</a></li>

<li class="toctree-l1"><a class="reference internal" href="Exoplanets.html">Exoplanets</a></li>
<li class="toctree-l1"><a class="reference internal" href="chaos.html">Chaos</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Random Walks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Markov%20Chains.html">Markov Chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParticlePhysics.html">Particle Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Climate.html">Climate Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Predator-Prey.html">Predator-Prey</a></li>
<li class="toctree-l1"><a class="reference internal" href="FluidDynamics.html">Fluid Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MachineLearningGalaxies.html">Classifying Galaxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC1.html">Quantum Computing 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC2.html">Building a Physical Qubit</a></li>
<li class="toctree-l1"><a class="reference internal" href="OrbitalDynamics2.html">Many Body Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="QC2_old.html">Quantum Computing 2</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/bkclark/IntroductionToComputationalPhysics/blob/main/IntroductionToComputationalPhysics/Random Walks.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Random Walks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Random Walks</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-unbiased-random-walks">Exercise 1: Unbiased Random Walks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-plot-a-random-walk">a.  Plot a random walk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-random-walk-averages">b. Random Walk Averages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-computing-average-distance">c. Computing average distance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-the-full-distribution">d. The full distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-diffusion-equations">e. Diffusion Equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#f-discrete-walks">f. Discrete Walks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-random-walks-in-two-dimensions">Exercise 2: Random Walks in Two Dimensions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-2d-walks">a. 2D Walks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-self-similarity">b. Self Similarity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-standard-deviation">c. Standard Deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-rotational-invariance">d. Rotational Invariance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-animation-extra-credit-5-points">e.  Animation (extra credit: 5 points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-diffusion-limited-aggregation">Exercise 3: Diffusion Limited Aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-dla-onto-a-core-point-at-the-origin">a. DLA onto a core point at the origin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-dla-onto-a-surface-extra-credit-5-points">b. DLA onto a surface (extra credit: 5 points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-path-integral-monte-carlo-extra-credit">Exercise 4: Path Integral Monte Carlo (extra credit)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-fixed-points">a. Fixed Points</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-connected-points">b.  Connected Points</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-fixed-region">c. Fixed Region</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-1d">d. 1D</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="random-walks">
<h1>Random Walks<a class="headerlink" href="#random-walks" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Author:</strong></p></li>
<li><p><strong>Date:</strong></p></li>
<li><p><strong>Time spent on this assignment:</strong></p></li>
</ul>
<p>Remember to execute this cell to load numpy and pylab.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">def</span> <span class="nf">resetMe</span><span class="p">(</span><span class="n">keepList</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">keepList</span><span class="o">=</span><span class="n">keepList</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;resetMe&#39;</span><span class="p">,</span><span class="s1">&#39;np&#39;</span><span class="p">,</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">keepList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
            <span class="n">ll</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">iiii</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
        <span class="n">jjjj</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="o">+</span><span class="n">iiii</span><span class="o">+</span><span class="s2">&quot;$&quot;</span>
        <span class="o">%</span><span class="k">reset_selective</span> -f {jjjj}
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
<section id="exercise-1-unbiased-random-walks">
<h2>Exercise 1: Unbiased Random Walks<a class="headerlink" href="#exercise-1-unbiased-random-walks" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>List of collaborators:</strong></p></li>
<li><p><strong>References you used in developing your code:</strong></p></li>
</ul>
<p>In 1827, the botanist Robert Brown noticed that pollen grains floating in water would bounce around randomly, but was confused as to the reason. In 1905, Einstein successfully described the motion of the pollen particles, dubbed <em>Brownian motion</em>, as a random walk resulting from microscopic particles bombarding the large pollen grain. For the first half of this unit, we will study the random motion of Brownâ€™s pollen grains in one and two dimensions.</p>
<p>First, letâ€™s visualize a random walk in one-dimension. Letâ€™s say that we are looking at a pollen particle stuck in a tube full of water so that it can only move left or right.</p>
<!--![image.png](attachment:image.png)-->
 <div><img src="https://clark.physics.illinois.edu/246img/RW1.png" width=400 alt="RW"></img><br></div><p>We mark its original position as <span class="math notranslate nohighlight">\(x_0=0 \mu m\)</span>. Every 30 seconds, we take a picture and record the position of the particle <span class="math notranslate nohighlight">\(x_t\)</span> in <span class="math notranslate nohighlight">\(\mu m\)</span>.  What we would record is something like this:</p>
<!--![image.png](attachment:image.png)-->
 <div><img src="https://clark.physics.illinois.edu/246img/RW2.png" width=450 alt="RW"></img><br></div><p>In simulating this random walk, we assumed that every time we measured the particleâ€™s position, it only depended on its previous position 30 seconds ago plus some random noise <span class="math notranslate nohighlight">\(\delta\)</span>.</p>
<div class="math notranslate nohighlight">
\[x_{t+1} = x_t + \delta.\]</div>
<p>In python, we can model the random jumps we see using numpyâ€™s random number
generators:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">averageJumpDistance</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">averageJumpDistance</span></code> is the typical distance the pollen particle jumps every 30 seconds, which I set to 6 <span class="math notranslate nohighlight">\(\mu m\)</span>. The <code class="docutils literal notranslate"><span class="pre">np.random.randn()</span></code> command generates a random number from the Gaussian (or Normal) distribution with mean zero and standard deviation one.</p>
<section id="a-plot-a-random-walk">
<h3>a.  Plot a random walk<a class="headerlink" href="#a-plot-a-random-walk" title="Permalink to this heading">#</a></h3>
<p>Generate your own random walk and plot itâ€™s location as a function of time.  Use the same parameters as in the above figure, i.e., simulate <span class="math notranslate nohighlight">\(6 \mu m\)</span> jumps every 30 seconds for 30,000 seconds, or 1,000 jumps.</p>
<p>The first thing you will notice is that random walks can vary a lot. Yours will probably look very different than the one in the above figure.</p>
<p>Generate another random walk using your code and notice that it too is different form your first walk.</p>
<p>On your plot, go ahead and generate 10 different random walks</p>
<p>To accomplish this, itâ€™s perfectly fine to go ahead and use a bunch of for loops.  If you are feeling fancy, it is possible to do this efficiently using <code class="docutils literal notranslate"><span class="pre">np.random.randn</span></code> and <code class="docutils literal notranslate"><span class="pre">np.cumsum</span></code>.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div></section>
<section id="b-random-walk-averages">
<h3>b. Random Walk Averages<a class="headerlink" href="#b-random-walk-averages" title="Permalink to this heading">#</a></h3>
<p>Since each random walk is different, we need to instead look at properties of the distribution of random walks to learn anything about them.  The simplest thing to look at is the average.</p>
<p>Generate 2000 random walks and evaluate the average position
<span class="math notranslate nohighlight">\(\langle x_k \rangle\)</span> after the <span class="math notranslate nohighlight">\(k'th\)</span> jump, for <span class="math notranslate nohighlight">\(k\)</span> running from 0 to 1000.</p>
<p>Before you compute the average positions, think about what you expect. Once you see the result, does it agree with your expectations? Does it make sense to you?<em>Make sure you pay attention to the scale compared to the scale of a single random walk.</em></p>
<p>What do I mean by averaging over walks? For example, say that we have two random walks, each made of 1,000 steps. I store the positions of the random walks as two length 1,000 arrays walk1 and walk2. Averaging over the two walks, the average position after each jump is an array I can calculate as</p>
<p><code class="docutils literal notranslate"><span class="pre">average_array</span> <span class="pre">=</span> <span class="pre">(walk1</span> <span class="pre">+</span> <span class="pre">walk2)</span> <span class="pre">/</span> <span class="pre">2.0</span></code>.</p>
<p>Thereâ€™s a more graceful way to do this than storing all the arrays, then calculating the average at the end. Instead, add the position after each jump while generating a walk into a single accumulator array. After you are done generating walks divide each element in your accumulator array by the number of walks.
Let me illustrate what I mean with a table of hypothetical data, for 2,000 random walks, each of 1,000 jumps.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>which random walk</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_0\)</span>(Âµm)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_1\)</span>(Âµm)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_2\)</span>(Âµm)</p></th>
<th class="head"><p>â€¦</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_{1000}\)</span>(Âµm)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>0.48</p></td>
<td><p>7.4</p></td>
<td><p>Â </p></td>
<td><p>0.81</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>-1.5</p></td>
<td><p>1.3</p></td>
<td><p>Â </p></td>
<td><p>7.5</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>0</p></td>
<td><p>-3.3</p></td>
<td><p>-2.6</p></td>
<td><p>Â </p></td>
<td><p>6.8</p></td>
</tr>
<tr class="row-odd"><td><p>â€¦</p></td>
<td><p>â€¦</p></td>
<td><p>â€¦</p></td>
<td><p>â€¦</p></td>
<td><p>Â </p></td>
<td><p>â€¦</p></td>
</tr>
<tr class="row-even"><td><p>1,999</p></td>
<td><p>0.</p></td>
<td><p>88.5</p></td>
<td><p>-42.2</p></td>
<td><p>nbsp;</p></td>
<td><p>74.1</p></td>
</tr>
<tr class="row-odd"><td><p>averages</p></td>
<td><p><span class="math notranslate nohighlight">\(\langle x_0\rangle=0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\langle x_1\rangle=37.8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\langle x_2\rangle=45.1\)</span></p></td>
<td><p>â€¦</p></td>
<td><p><span class="math notranslate nohighlight">\(\langle x_{1000}\rangle=0.51\)</span></p></td>
</tr>
</tbody>
</table>
<p>Hereâ€™s my plot:</p>
<!--![image.png](attachment:image.png)-->
 <div><img src="https://clark.physics.illinois.edu/246img/RW3.png" width=450 alt="RW"></img><br></div> <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-computing-average-distance">
<h3>c. Computing average distance<a class="headerlink" href="#c-computing-average-distance" title="Permalink to this heading">#</a></h3>
<p>As you should have noticed, the average is not telling you very much.  This is because youâ€™re just as likely to move left as right.  Therefore, on average, youâ€™re not going anywhere.</p>
<p>We need to look at something else. In some sense, we want to know how far away you are from the origin.  One way that is conceptually nice to quantify this (although not necessarily the best) is to just plot the average absolute value of your location.  Go ahead and start by making this plot.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (End)"></img><br></div><p>A slightly better quantity to look at which answers a similar question is the standard deviation of your random walks</p>
<div class="math notranslate nohighlight">
\[ \sqrt{\frac{1}{N} \sum_{j=1}^N (x_k - \langle x_k\rangle)^2} \]</div>
<div class="math notranslate nohighlight">
\[=\sqrt{\langle x_k^2\rangle - \langle x_k\rangle^2}\]</div>
<p>For the <span class="math notranslate nohighlight">\(k\)</span>â€™th jump the RMS tells us how much the pollen particleâ€™s position will have tended to drift by the time it executes the <span class="math notranslate nohighlight">\(k\)</span>â€™th jump in a typical walk.</p>
<p>All you need to do is calculate the average value of <span class="math notranslate nohighlight">\(x_k^2\)</span> and the average value of <span class="math notranslate nohighlight">\(x_k\)</span>. So each time you generate a walk, add the position of each jump into an accumulator array and the square of the position into another accumulator array. At the end, divide the contents of each bin in your accumulator arrays by the number of walks.</p>
<p>Write code to compute the RMS displacement as a function of time using 2,000 random walks and plot the result. You should get something similar to the following curve:</p>
<!--![image.png](attachment:image.png)-->
 <div><img src="https://clark.physics.illinois.edu/246img/RW4.png" width=450 alt="RW"></img><br></div> <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (Start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (End)"></img><br></div><p>We see that, on average, there is a very clear trend for the pollen particle to drift farther away over time. If we ignore the small value of the average position <span class="math notranslate nohighlight">\(\langle x_k \rangle\)</span> which is zero we can write</p>
<div class="math notranslate nohighlight">
\[RMS_\textrm{kth jump} = \sqrt{\langle x_k^2\rangle - \langle x_k \rangle^2} \approx \sqrt{\langle x_k^2 \rangle} \propto \sqrt{t_k}\]</div>
<p>The square root here is very important and characterizes all diffusive motion. Note that a free particle moving with constant velocity will have <span class="math notranslate nohighlight">\(x\propto t\)</span>. Such motion is sometimes called ballistic motion. The main takeaway is that diffusive motion is much slower than ballistic motion. Intuitively, this makes sense since, in diffusive motion, a particle is being severely slowed down by random bombardments from its environment.</p>
<p>ðŸ¦‰In addition to the plot above, make another log-log plot (of the same data) and show:</p>
<ul class="simple">
<li><p>you get a line on this log-log plot (this shows that <span class="math notranslate nohighlight">\(x \propto t^{\alpha}\)</span>)</p></li>
<li><p>Find the value of <span class="math notranslate nohighlight">\(\alpha\)</span> by computing the slope of your (log-log) line using <code class="docutils literal notranslate"><span class="pre">np.polyfit</span></code>. Show that it goes as <span class="math notranslate nohighlight">\(t^{1/2}\)</span></p></li>
</ul>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (End)"></img><br></div></section>
<section id="d-the-full-distribution">
<h3>d. The full distribution<a class="headerlink" href="#d-the-full-distribution" title="Permalink to this heading">#</a></h3>
<p>So far weâ€™ve been looking at some summary statistics as of the distribution.  These are good pieces of information to start figuring out whatâ€™s going on.  But, at some point it is helpful to look at the full distribution.</p>
<p>Letâ€™s focus here on what the distribution looks like after 2 steps, 10 steps, 100 steps, and 500 steps.</p>
<p>To do this, you want to plot a histogram of your distribution - i.e. something like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">locs</span><span class="p">[:,</span><span class="mi">100</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot all four histograms on the same plot.</p>
<p>You should see the distribution always looks gaussian with the width of the gaussian growing as the number of steps grow.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (Start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (End)"></img><br></div></section>
<section id="e-diffusion-equations">
<h3>e. Diffusion Equations<a class="headerlink" href="#e-diffusion-equations" title="Permalink to this heading">#</a></h3>
<p>Previously in this course, weâ€™ve worked on diffusion equations.  Now weâ€™ve move to stochastic random walks.  The diffusion equations weâ€™ve worekd with are deterministic so obviously canâ€™t match each stochastic walk.  But, the distribution as a function of time is something you might imagine could be correctly matched with differential equations. This is in fact the case - stochastic random walks are represented by the diffusion equation:</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial \rho}{\partial t} = D \frac{\partial^2 \rho}{\partial x^2}\]</div>
<p>Here <span class="math notranslate nohighlight">\(D=a^2/2\)</span> is the diffusion constant where <span class="math notranslate nohighlight">\(a\)</span> is our step size (in this case 6).</p>
<p>Write some code to simulate this diffusion equation from the initial conditions <span class="math notranslate nohighlight">\(\rho(0)=\exp[-x^2/2\sigma^2]\)</span> where <span class="math notranslate nohighlight">\(\sigma=6\)</span>.  This is where our random walks are after their first step.</p>
<p>To simulate this differential equation, you are going to want to let <span class="math notranslate nohighlight">\(\rho\)</span> be a density of random walks represented by a vector.  I set up my <span class="math notranslate nohighlight">\(\rho\)</span> by doing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dx</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">points</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="p">))</span>
<span class="n">xs</span><span class="o">=</span><span class="n">dx</span><span class="o">*</span><span class="p">(</span><span class="n">points</span><span class="o">-</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rho</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">])</span>
</pre></div>
</div>
<p>You can then plot it by doing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">rho</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span>
</pre></div>
</div>
<p>(we scale it so that the integral of our density is 1.0).</p>
<p>Having this as your initial condition now you want to time-step your density.  To do this, you should compute <span class="math notranslate nohighlight">\(\frac{\partial^2 \rho}{\partial x^2}\)</span> and then move forward the <span class="math notranslate nohighlight">\(\rho\)</span>.  Use a time step <span class="math notranslate nohighlight">\(dt=dx^2/100\)</span>.</p>
<p>(It may or may not be helpful to use <code class="docutils literal notranslate"><span class="pre">np.roll(rho,1)</span></code> and <code class="docutils literal notranslate"><span class="pre">np.roll(rho,-1)</span></code>)</p>
<p>Compare the distribution that you get at times <span class="math notranslate nohighlight">\(t=2.0, t=10.0, and t=30.0\)</span> against the histograms you got from the random walks (remembering to also scale the density of the random walks histograms like <code class="docutils literal notranslate"><span class="pre">plt.hist(locs[:,10],bins=50,density=True)</span></code>.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (Start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (End)"></img><br></div></section>
<section id="f-discrete-walks">
<h3>f. Discrete Walks<a class="headerlink" href="#f-discrete-walks" title="Permalink to this heading">#</a></h3>
<p>So far weâ€™ve been doing random walks with gaussian steps.  We would like to see what changes if instead we did discrete walks - i.e. at each step we are going to walk either left exactly 6 units or right exactly 6 units.</p>
<p>Write code to do this random walk and then print the histogram on separate plots at</p>
<ul class="simple">
<li><p>2 steps (with the gaussian histogram on top of it)</p></li>
<li><p>100 steps (with the gaussian histogram on top of it).</p></li>
</ul>
<p>i.e. for the 2 step histogram I wrote</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">locs_discrete</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">locs</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>For the 2 step histogram you should see a qualitative difference.  But once you get to 100 steps, it seems that there is no dependence on the distribution for either the discrete or gaussian steps.  This is a form of universality (and something we will see even more starkly in the two-dimensional case below).</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (Start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (End)"></img><br></div></section>
</section>
<section id="exercise-2-random-walks-in-two-dimensions">
<h2>Exercise 2: Random Walks in Two Dimensions<a class="headerlink" href="#exercise-2-random-walks-in-two-dimensions" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>List of collaborators:</strong></p></li>
<li><p><strong>References you used in developing your code:</strong></p></li>
</ul>
<p>Now, letâ€™s consider a two-dimensional random walk. We put our pollen particle on a petri dish covered with a thin layer of water so that it can move in a plane.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/RW5.png" width=1000 alt="RW"></img><br></div><section id="a-2d-walks">
<h3>a. 2D Walks<a class="headerlink" href="#a-2d-walks" title="Permalink to this heading">#</a></h3>
<p>We mark the pollen grainâ€™s initial position as   <span class="math notranslate nohighlight">\((x_0,y_0)=(0,0) \mu  m\)</span>. We measure every 30 seconds and see each component of the pollen particleâ€™s position <span class="math notranslate nohighlight">\(x_k,y_k\)</span> jump from its previous
position. Weâ€™ll expect the typical jump distance to be <span class="math notranslate nohighlight">\(\approx 6\sqrt{2}\)</span> <span class="math notranslate nohighlight">\(\mu m\)</span>.</p>
<p>Write code that generates 2,000 two-dimensional <em>gaussian</em> random walks of 5000 steps.  Start by plotting y vs x of 10 such random walks.</p>
<p>Do the same thing for 10 discrete (up,down,left,right) random walks.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div></section>
<section id="b-self-similarity">
<h3>b. Self Similarity<a class="headerlink" href="#b-self-similarity" title="Permalink to this heading">#</a></h3>
<p>Brownian random walks are self-similar. As you zoom into pieces of the figure, it looks qualitatively the same on all scales.
Make a random walk of 128,000 steps.  Then plot (on separate plots)</p>
<ul class="simple">
<li><p>the random walk</p></li>
<li><p>the first half of the random walk (multiplying the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> by 2)</p></li>
<li><p>the first quarter of the random walk  (multiplying the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> by 4)</p></li>
<li><p>the first eighth of the random walk  (multiplying the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> by 8)</p></li>
<li><p>the first 1/16 of the random walk  (multiplying the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> by 16)</p></li>
<li><p>the first 1/32 of the random walk  (multiplying the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> by 32)</p></li>
</ul>
<p>Notice that these plots all look qualitatively similar. This is what I get:</p>
 <div><img src="https://clark.physics.illinois.edu/246img/selfSimilar.png" width=500 alt="RW"></img><br></div> <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div> <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-standard-deviation">
<h3>c. Standard Deviation<a class="headerlink" href="#c-standard-deviation" title="Permalink to this heading">#</a></h3>
<p>Like in the 1D case, we expect the average <span class="math notranslate nohighlight">\(\langle x_k \rangle\)</span> to be zero.  Letâ€™s just go ahead and plot
$<span class="math notranslate nohighlight">\(\langle r \rangle = \langle \sqrt{x_k^2 + y_k^2}  \rangle\)</span>$
<em>for 1000 copies of both the gaussian and discrete walk on the same plot</em></p>
<p>You should obtain a similar curve to that obtained in the one-dimensional case, but increased somewhat in amplitude.Even in two-dimensions, the displacement goes with the square root of time. <strong>Show this by also plotting it on a log-log plot and fitting the slope</strong>.</p>
<p>It turns out that you also see this behavior in three dimensions. In general, the RMS displacement always scales as the square root of time for any physical system undergoing diffusive motion.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (Start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (End)"></img><br></div></section>
<section id="d-rotational-invariance">
<h3>d. Rotational Invariance<a class="headerlink" href="#d-rotational-invariance" title="Permalink to this heading">#</a></h3>
<p>Now we are going to show that in the 2D case, the discrete walks restore the rotational invariance of the gaussian walk.</p>
<p>To do this, we want to put the location of the 2000 2d coordinates at t=1000 steps.</p>
<p>Do this for both the discrete and guassian walks.</p>
<p>You should see that
(1) They look the same and
(2) More interestingly, the discrete case looks rotationally invariant (like a circle) even though it can only go up, down, left, right.   This is an  emergent rotational symmetry.</p>
  <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="e-animation-extra-credit-5-points">
<h3>e.  Animation (extra credit: 5 points)<a class="headerlink" href="#e-animation-extra-credit-5-points" title="Permalink to this heading">#</a></h3>
<p>Animate the two-dimensional random walk.  You may find the animation code from previous assignments helpful.</p>
</section>
</section>
<section id="exercise-3-diffusion-limited-aggregation">
<h2>Exercise 3: Diffusion Limited Aggregation<a class="headerlink" href="#exercise-3-diffusion-limited-aggregation" title="Permalink to this heading">#</a></h2>
<p>In the previous exercises we learned some properties of random walks.  In this exercise, we will apply random walks to the application of deposition.  This will be done by modeling it with diffusion limited aggregation (DLA).</p>
<section id="a-dla-onto-a-core-point-at-the-origin">
<h3>a. DLA onto a core point at the origin<a class="headerlink" href="#a-dla-onto-a-core-point-at-the-origin" title="Permalink to this heading">#</a></h3>
<p>In DLA, we do the following:</p>
<ul class="simple">
<li><p>Start with a particle at some fixed point (say the center of a box).</p></li>
<li><p>Repeat the following:</p>
<ul>
<li><p>Add a new particle someplace on the boundary (anywhere on the four walls).</p></li>
<li><p>Move this particle using a discrete random walk (left, right, up, down).  If it tries to move in the direction of one of the walls, it shouldnâ€™t stick (but also shouldnâ€™t go anywhere).</p></li>
<li><p>Once it is touching (up or down or left or right) a currently stuck particle, it should stick.</p></li>
</ul>
</li>
</ul>
<p>To accomplish this, I kept a two-dimensional numpy array which kept track of the location of the stuck particles and the currently moving particle.</p>
<p>At the end, you want to go ahead and plot the location of your stuck particles.  To do this, use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is your numpy grid.</p>
<p>Start with a box of size <span class="math notranslate nohighlight">\(100 \times 100\)</span>.<br />
Use 1000 different particles.</p>
<p>This simulation is a little slow.  On colab, it takes me approximately 2 minutes.  For testing you might want to turn down the number of different particles that you use.</p>
<p>It also also interesting to see the picture when you have a larger box (<span class="math notranslate nohighlight">\(200 \times 200\)</span>) but this is much slower (and not required as part of the assignment).</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-dla-onto-a-surface-extra-credit-5-points">
<h3>b. DLA onto a surface (extra credit: 5 points)<a class="headerlink" href="#b-dla-onto-a-surface-extra-credit-5-points" title="Permalink to this heading">#</a></h3>
<p>In the previous section you did DLA onto a core point.  If you are interested in understanding deposition onto a surface, you want to modify your DLA to come in at the top and stick either at the bottom or if they hit any previously stuck point.  Implement this.</p>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### ANSWER ME</span>
</pre></div>
</div>
</div>
</div>
 <div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
<section id="exercise-4-path-integral-monte-carlo-extra-credit">
<h2>Exercise 4: Path Integral Monte Carlo (extra credit)<a class="headerlink" href="#exercise-4-path-integral-monte-carlo-extra-credit" title="Permalink to this heading">#</a></h2>
<p><em>(Extra credit: 20 points)</em></p>
<ul class="simple">
<li><p><strong>List of collaborators:</strong></p></li>
<li><p><strong>References you used in developing your code:</strong></p></li>
</ul>
<p>(Some of the explanaitions here are abbreviated even for an extra credit.  I am sneakily having you do Quantum Monte Carlo (QMC) here.  If you want to do this extra credit [particularly after part <strong>a.</strong>] you should probably come talk to me)</p>
<section id="a-fixed-points">
<h3>a. Fixed Points<a class="headerlink" href="#a-fixed-points" title="Permalink to this heading">#</a></h3>
<p>Imagine we were to produce the walks in exercise 2 and then throw out any of the walks that didnâ€™t end at <span class="math notranslate nohighlight">\((x,y)=(5,5)\)</span>.  This would induce some probability distribution over walks.  Unfortunately this would be very inefficient.  Instead figure out (read about Levy Flights and Brownian bridges) how to generate the same probability distribution as this efficiently. Write code that does so and then plot 10 paths between two fixed points (you can choose where they are fixed).</p>
</section>
<section id="b-connected-points">
<h3>b.  Connected Points<a class="headerlink" href="#b-connected-points" title="Permalink to this heading">#</a></h3>
<p>Start with 100 connected (in order) points all at <span class="math notranslate nohighlight">\((0,0)\)</span> (i.e. <span class="math notranslate nohighlight">\(x_0=(0,0); x_1=(0,0);...\)</span> . We will have <span class="math notranslate nohighlight">\(x_{99}\)</span> connceted to <span class="math notranslate nohighlight">\(x_0.\)</span> Choose a window of ten points at random (maybe 33-43) and use the algorithm you described in <strong>4a</strong> to regenerate points <span class="math notranslate nohighlight">\(x_{34},x_{35},..,x_{42}\)</span>.   Then pick another window and do this again.  Repeat this process 1000 times and</p>
<ul class="simple">
<li><p>make a plot of your points (connected by lines)</p></li>
<li><p>Report the average distance between consecutive points.</p></li>
<li><p>Make a histogram of the distances between average points.</p></li>
</ul>
</section>
<section id="c-fixed-region">
<h3>c. Fixed Region<a class="headerlink" href="#c-fixed-region" title="Permalink to this heading">#</a></h3>
<p>Repeat <strong>b.</strong> with the constraint that you should just not rebuild your window if, after making the new points, any of the points are outside a box that extends <span class="math notranslate nohighlight">\(-1 \leq x \leq 1\)</span> and <span class="math notranslate nohighlight">\(-1 \leq y \leq 1\)</span>.</p>
<p>Graph the probability points are at given places in the box.</p>
</section>
<section id="d-1d">
<h3>d. 1D<a class="headerlink" href="#d-1d" title="Permalink to this heading">#</a></h3>
<p>Redo this for one dimension.</p>
<p>**Acknowledgements:</p>
<ul class="simple">
<li><p>Problems 1abc 2ac: George Gollin and Ryan Levy and Eli Chertkov (original); Bryan Clark (modifications)</p></li>
<li><p>Problems 1de 2b: Bryan Clark (original)</p></li>
<li><p>Problems 3,4: Bryan Clark (original)</p></li>
</ul>
<hr class="docutils" />
<p>Â© Copyright 2023</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chaos.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chaos</p>
      </div>
    </a>
    <a class="right-next"
       href="Markov%20Chains.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Markov Chains</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-unbiased-random-walks">Exercise 1: Unbiased Random Walks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-plot-a-random-walk">a.  Plot a random walk</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-random-walk-averages">b. Random Walk Averages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-computing-average-distance">c. Computing average distance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-the-full-distribution">d. The full distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-diffusion-equations">e. Diffusion Equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#f-discrete-walks">f. Discrete Walks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-random-walks-in-two-dimensions">Exercise 2: Random Walks in Two Dimensions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-2d-walks">a. 2D Walks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-self-similarity">b. Self Similarity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-standard-deviation">c. Standard Deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-rotational-invariance">d. Rotational Invariance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-animation-extra-credit-5-points">e.  Animation (extra credit: 5 points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-diffusion-limited-aggregation">Exercise 3: Diffusion Limited Aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-dla-onto-a-core-point-at-the-origin">a. DLA onto a core point at the origin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-dla-onto-a-surface-extra-credit-5-points">b. DLA onto a surface (extra credit: 5 points)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-path-integral-monte-carlo-extra-credit">Exercise 4: Path Integral Monte Carlo (extra credit)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-fixed-points">a. Fixed Points</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-connected-points">b.  Connected Points</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-fixed-region">c. Fixed Region</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-1d">d. 1D</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bryan Clark; George Gollin; Ryan Levy
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>